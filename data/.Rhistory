setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
stud <- read.csv("student-por.csv")
stud$alc <- stud$Dalc + stud$Walc
stud.ex <- subset(stud, select = c("studytime", "alc"))
View(stud)
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
stud <- read.csv("student-por.csv")
stud$alc <- stud$Dalc + stud$Walc
View(stud)
stud$grade <- (stud$G1 + stud$G2 +stud$G3) / 3
table(stud$reason)
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
data.source=merge(ptgs.course,math.course,by=c("school","sex","age","address","famsize","Pstatus",
"Medu","Fedu","Mjob","Fjob","reason","nursery","internet",
"guardian","guardian","traveltime","studytime","failures",
"schoolsup","famsup","activities","higher","romantic",
"famrel","freetime","goout","Dalc","Walc","health","absences"))
View(data.source)
print(nrow(data.source))
print(str(data.source))
print(summary(data.source))
head(data.source)
summary(data.source)
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
data.source <- merge(ptgs.course,math.course,by=c("school","sex","age","address","famsize","Pstatus",
"Medu","Fedu","Mjob","Fjob","reason","nursery","internet",
"guardian","guardian","traveltime","studytime","failures",
"schoolsup","famsup","activities","higher","romantic",
"famrel","freetime","goout","Dalc","Walc","health","absences"))
head(data.source)
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
data.source <- merge(ptgs.course,math.course,by=c("school","sex","age","address","famsize","Pstatus",
"Medu","Fedu","Mjob","Fjob","reason","nursery","internet",
"guardian","guardian","traveltime","studytime","failures",
"schoolsup","famsup","activities","higher","romantic",
"famrel","freetime","goout","Dalc","Walc","health","absences"))
head(data.source)
data.source$mathgrades <- rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades <- rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
str1=ggplot(data.source, aes(x=mathgrades, y=portgrades)) +
geom_point(aes(colour=factor(Dalc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
library(ggplot2)
str1=ggplot(data.source, aes(x=mathgrades, y=portgrades)) +
geom_point(aes(colour=factor(Dalc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
str2=ggplot(data.source, aes(x=mathgrades, y=portgrades))+
geom_point(aes(colour=factor(Walc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
grid.arrange(str1,str2,nrow=2)
library(gridExtra)
grid.arrange(str1,str2,nrow=2)
with(data.source,
tapply(mathgrades, portgrades,function(x)
c(mean(x) + c(-2, 2) * sd(x)/sqrt(length(x)))))
with(data.source,
tapply(mathgrades, Dalc ,function(x)
c(mean(x) + c(-2, 2) * sd(x)/sqrt(length(x)))))
t.test(mathgrades ~ Dalc, data=data.source)
t.test(mathgrades ~ sex, data=data.source)
View(math.course)
data.source$alc <- mapvalues(data.source$Dalc,
from = c("Very Low", "Low", "Medium", "High", "Very High"),
to = c("no", "yes", "yes", "yes", "yes"))
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
data.source <- merge(ptgs.course,math.course,by=c("school","sex","age","address","famsize","Pstatus",
"Medu","Fedu","Mjob","Fjob","reason","nursery","internet",
"guardian","guardian","traveltime","studytime","failures",
"schoolsup","famsup","activities","higher","romantic",
"famrel","freetime","goout","Dalc","Walc","health","absences"))
data.source$alcohol <- data.source$Dacl + data.source$Walc
data.source$alcohol <- data.source$Dacl + data.source$Walc
data.source$alcohol <- (data.source$Dacl + data.source$Walc)
data.source$alcohol <- 1
data.source$alcohol <- data.source$Dalc + data.source$Walc
max(data.source$alcohol)
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alc <- as.factor(data.source$alc)
data.source$alc <- mapvalues(data.source$Walc,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes","yes"))
data.source$alc <- mapvalues(data.source$Walc,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
data.source <- merge(ptgs.course,math.course,by=c("school","sex","age","address","famsize","Pstatus",
"Medu","Fedu","Mjob","Fjob","reason","nursery","internet",
"guardian","guardian","traveltime","studytime","failures",
"schoolsup","famsup","activities","higher","romantic",
"famrel","freetime","goout","Dalc","Walc","health","absences"))
head(data.source)
summary(data.source)
data.source$mathgrades <- rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades <- rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
t.test(mathgrades ~ alc, data=data.source)
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
View(r.sqr)
summary(r.sqr)$r.squared
sqrt(summary(r.sqr)$r.squared)
summary(data.source)
data.source$mathgrades=rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades=rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
data.source$mathgrades=rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades=rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
data.source$mathgrades=rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades=rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
library(ggplot2)
str1=ggplot(data.source, aes(x=mathgrades, y=portgrades)) +
geom_point(aes(colour=factor(Dalc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
str2=ggplot(data.source, aes(x=mathgrades, y=portgrades))+
geom_point(aes(colour=factor(Walc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
data.source$mathgrades=rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades=rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
data.source$mathgrades=rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades=rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
library(ggplot2)
str1=ggplot(data.source, aes(x=mathgrades, y=portgrades)) +
geom_point(aes(colour=factor(Dalc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
str2=ggplot(data.source, aes(x=mathgrades, y=portgrades))+
geom_point(aes(colour=factor(Walc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
library(ggplot2)
str1=ggplot(data.source, aes(x=mathgrades, y=portgrades)) +
geom_point(aes(colour=factor(Dalc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
str2=ggplot(data.source, aes(x=mathgrades, y=portgrades))+
geom_point(aes(colour=factor(Walc)))+ scale_colour_hue(l=25,c=150)+
geom_smooth(method = "lm", se = FALSE)
library(gridExtra)
grid.arrange(str1,str2,nrow=2)
setwd("D:/2018.07 R_DataAnalysis/2018SUMMER_R/data")
ptgs.course <- read.csv("student-por.csv")
math.course <- read.csv("student-mat.csv")
data.source <- merge(ptgs.course,math.course,by=c("school","sex","age","address","famsize","Pstatus",
"Medu","Fedu","Mjob","Fjob","reason","nursery","internet",
"guardian","guardian","traveltime","studytime","failures",
"schoolsup","famsup","activities","higher","romantic",
"famrel","freetime","goout","Dalc","Walc","health","absences"))
head(data.source)
summary(data.source)
data.source$mathgrades <- rowMeans(cbind(data.source$G1.x,data.source$G2.x,data.source$G3.x))
data.source$portgrades <- rowMeans(cbind(data.source$G1.y,data.source$G2.y,data.source$G3.y))
data.source$alcohol <- data.source$Dalc + data.source$Walc
library(plyr)
data.source$Dalc <- as.factor(data.source$Dalc)
data.source$Dalc <- mapvalues(data.source$Dalc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$Walc <- as.factor(data.source$Walc)
data.source$Walc <- mapvalues(data.source$Walc,
from = 1:5,
to = c("Very Low", "Low", "Medium", "High", "Very High"))
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
print(summary(r.sqr)$r.squared, sqrt(summary(r.sqr)$r.squared))
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
summary(r.sqr)$r.squared
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
print(summary(r.sqr)$r.squared)
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
print(summary(r.sqr)$r.squared, summary(r.sqr)$r.squared)
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
print(summary(r.sqr)$r.squared)
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
print(summary(r.sqr)$r.squared) + print(sqrt(summary(r.sqr)$r.squared))
r.sqr <- lm(mathgrades ~ portgrades, data=data.source)
print(summary(r.sqr)$r.squared)
print(sqrt(summary(r.sqr)$r.squared))
new.source <-rbind(mathcourse, ptfscourse) #combine the two datasets
# and eliminate the repeats:
new.source <-rbind(math.course, ptfs.course) #combine the two datasets
new.source <-rbind(math.course, ptgs.course) #combine the two datasets
apply.source <- new.source %>% distinct(school,sex,age,address,famsize,Pstatus,
Medu,Fedu,Mjob,Fjob,reason,
guardian,traveltime,studytime,failures,
schoolsup, famsup,activities,nursery,higher,internet,
romantic,famrel,freetime,goout,Dalc,Walc,health,absences, .keep_all = TRUE)
library(dplyr)
new.source <-rbind(math.course, ptgs.course) #combine the two datasets
# and eliminate the repeats:
apply.source <- new.source %>% distinct(school,sex,age,address,famsize,Pstatus,
Medu,Fedu,Mjob,Fjob,reason,
guardian,traveltime,studytime,failures,
schoolsup, famsup,activities,nursery,higher,internet,
romantic,famrel,freetime,goout,Dalc,Walc,health,absences, .keep_all = TRUE)
View(apply.source)
View(new.source)
apply.source$avggrades=rowMeans(cbind(apply.source$G1,apply.source$G2,apply.source$G3))
apply.source$alcohol <- data.source$Dalc + data.source$Walc
apply.source$alcohol <- apply.source$Dalc + apply.source$Walc
data.source$alcohol <- as.factor(data.source$alcohol)
data.source$alc <- mapvalues(data.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
apply.source$alcohol <- as.factor(apply.source$alcohol)
apply.source$alc <- mapvalues(apply.source$alcohol,
from = 2:8,
to = c("no","yes","yes","yes","yes","yes","yes"))
apply.source$alc <- mapvalues(apply.source$alcohol,
from = 2:10,
to = c("no","yes","yes","yes","yes","yes","yes","yes","yes"))
library(dplyr)
new.source <-rbind(math.course, ptgs.course) #combine the two datasets
# and eliminate the repeats:
apply.source <- new.source %>% distinct(school,sex,age,address,famsize,Pstatus,Medu,Fedu,Mjob,Fjob,reason,
guardian,traveltime,studytime,failures,schoolsup,
famsup,activities,nursery,higher,internet,romantic,
famrel,freetime,goout,Dalc,Walc,health,absences, .keep_all = TRUE)
apply.source$avggrades <- rowMeans(cbind(apply.source$G1,apply.source$G2,apply.source$G3))
apply.source$alcohol <- apply.source$Dalc + apply.source$Walc
apply.source$alcohol <- as.factor(apply.source$alcohol)
apply.source$alc <- mapvalues(apply.source$alcohol,
from = 2:10,
to = c("no","yes","yes","yes","yes","yes","yes","yes","yes"))
head(apply.source)
t.test(math ~ gender, data = dta)
t.test(avggrades ~ alc, data=apply.source)
t.test(avggrades ~ alc, data=apply.source, var.equal = TRUE)
t.test(avggrades ~ alc, data=apply.source, var.equal = TRUE)
t.test(avggrades ~ alc, data=apply.source)
t.test(avggrades ~ alc, data=apply.source)
